# FX & Currency Risk Analysis Module

## Обзор
Модуль "FX & Currency Risks" предоставляет полноценный инструментарий для анализа валютных рисков и сценарного моделирования изменения курсов валют.

## Основные компоненты

### 1. Оценка валютного риска портфеля
- **Автоматический расчет уровня риска** на основе диверсификации активов
- Уровни риска: Низкий, Средний, Средне-высокий, Высокий
- Показатели: количество валют в портфеле, количество юрисдикций

### 2. Визуализация распределения активов

#### Диаграмма по валютам (Pie Chart)
- Круговая диаграмма показывает процентное распределение активов по валютам
- Каждая валюта имеет уникальный цвет для легкой идентификации
- Интерактивные подсказки при наведении

#### Диаграмма по странам (Bar Chart)
- Столбчатая диаграмма показывает распределение активов по юрисдикциям
- Все балансы конвертированы в базовую валюту (KZT) для сравнения
- Флаги стран для визуальной идентификации

### 3. История влияния курсов на баланс
- **Area Chart** показывает изменение общего баланса за последние 6 месяцев
- Отображает исторические курсы USD, EUR, RUB
- Помогает понять волатильность портфеля

### 4. Инструмент сценарного анализа (Scenario Tool)

#### Интерактивные ползунки
- Для каждой валюты (USD, EUR, KZT, RUB)
- Диапазон изменения: от -10% до +10%
- Шаг изменения: 0.5%
- Визуальное отображение текущего и нового курса

#### Расчет влияния
1. **Новый баланс**
   - Пересчет всего портфеля с новыми курсами
   - Показывает абсолютное и процентное изменение

2. **Влияние на налоги**
   - Приблизительный расчет: ~10% от изменения баланса
   - Помогает оценить налоговые последствия

3. **Cash Flow после налогов**
   - Чистое изменение: ~85% от изменения (после вычета налогов)
   - Реальное влияние на ликвидность

#### Детальная разбивка
- Показывает влияние по каждой валюте отдельно
- Текущий баланс → Новый баланс
- Абсолютное изменение в KZT
- Процент изменения курса

### 5. Рекомендации по снижению рисков

#### Автоматические предупреждения:
- **Высокий риск** (все активы в одной валюте)
  - Рекомендация: диверсифицировать портфель
  
- **Значительное изменение** (>5%)
  - Предупреждение о волатильности
  - Рекомендация рассмотреть стратегии хеджирования

#### Общие рекомендации:
1. **Мониторинг курсов**
   - Настройка уведомлений при изменении >2%
   
2. **Естественное хеджирование**
   - Выравнивание доходов и расходов в одной валюте
   
3. **Диверсификация**
   - Распределение активов между валютами

## Технические детали

### Компоненты
- **FXRiskAnalysis.tsx** - основной компонент модуля
- Интеграция в Dashboard.tsx в секции 'currency'

### Используемые библиотеки
- **recharts** - для всех графиков и диаграмм
- **lucide-react** - иконки

### Цветовая схема валют
```typescript
KZT: '#3b82f6' (синий)
USD: '#10b981' (зеленый)
EUR: '#8b5cf6' (фиолетовый)
RUB: '#f59e0b' (оранжевый)
GEL: '#ec4899' (розовый)
AMD: '#06b6d4' (голубой)
```

### Расчеты

#### Уровень риска
```typescript
- 1 валюта → Высокий
- Доля крупнейшей валюты >70% → Средне-высокий
- Доля крупнейшей валюты >50% → Средний
- Иначе → Низкий
```

#### Сценарный анализ
```typescript
Новый курс = Текущий курс × (1 + Изменение% / 100)
Новый баланс = Сумма(Баланс в валюте × Новый курс)
Налоги ≈ |Изменение баланса| × 0.1
Cash Flow ≈ Изменение баланса × 0.85
```

## Использование

### Доступ к модулю
1. Войти в Dashboard
2. Перейти в раздел "FX Control" / "Валютный контроль"
3. Прокрутить вниз до секции "FX & Currency Risks"

### Работа со сценариями
1. Используйте ползунки для изменения курсов валют
2. Наблюдайте за изменением показателей в реальном времени
3. Просматривайте детальную разбивку по валютам
4. Используйте кнопку "Reset" для возврата к текущим курсам

### Интерпретация результатов

#### Положительное изменение (зеленый цвет)
- Рост курса увеличивает ваш баланс
- Возможны дополнительные налоги
- Улучшение cash flow

#### Отрицательное изменение (красный цвет)
- Падение курса уменьшает ваш баланс
- Возможное снижение налогов
- Ухудшение cash flow

#### Предупреждения
- Желтое предупреждение появляется при изменении >5%
- Рекомендуется рассмотреть стратегии хеджирования

## Многоязычность
- Полная поддержка английского и русского языков
- Автоматическое переключение при смене языка в Dashboard

## Будущие улучшения
- [ ] Экспорт сценариев в PDF
- [ ] Сохранение сценариев для сравнения
- [ ] Интеграция с реальными курсами валют (API)
- [ ] Расширенные стратегии хеджирования
- [ ] Прогнозирование курсов с помощью ML
- [ ] Исторический анализ за больший период
- [ ] Корреляция валют
- [ ] VaR (Value at Risk) расчет
